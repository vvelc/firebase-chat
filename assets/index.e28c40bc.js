import{i as k,B as I,u as M,q as L,W as E,S as A,y as j,c as F,C as O,r as m,j as c,a as e,g as B,G as P,b as D,s as $,F as b,A as f,d as R,I as v,L as _,e as H,f as G,h as q,E as T,k as U,P as V,l as J,m as K,N as g,n as W,o as z,R as Q,p as Y}from"./vendor.a6994319.js";const Z=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&t(l)}).observe(document,{childList:!0,subtree:!0});function i(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function t(a){if(a.ep)return;a.ep=!0;const r=i(a);fetch(a.href,r)}};Z();const X={apiKey:"AIzaSyBCH0vgZNEGFCpbsb2o1kC22rQS9F38m50",authDomain:"fir-chat-vvelc.firebaseapp.com",projectId:"fir-chat-vvelc",storageBucket:"fir-chat-vvelc.appspot.com",messagingSenderId:"944421597173",appId:"1:944421597173:web:137d0fbfae644416647abc"},w=k(X),N={_db:I(w),monitor(){return M(L(A(this._db,"messages"),E("date")),{snapshotListenOptions:{includeMetadataChanges:!0}})},async sendMessage(s,n,i,t){console.log(t),await j(O(this._db,"messages",s),{content:n,date:new F(i,0),author:JSON.stringify(t)})}};function ee({}){const[s,n,i]=N.monitor();return m.exports.useEffect(()=>{s==null||s.docs.forEach(t=>{})},[s]),c("div",{className:"chatbox-block glass glass-shadows",children:[e(te,{}),e(ae,{}),e(oe,{})]})}const u={_auth:B(w),async authNewUser(){const s=new P;return!!await(()=>$(this._auth,s).catch(a=>null))()},getAuthState(){return D(this._auth)},signOut(){this._auth.signOut()}};function se({content:s,author:n,date:i,photoURL:t}){const[a,r,l]=u.getAuthState(),d=new Date(i.seconds*1e3).toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit"});return e(b,{children:n==(a==null?void 0:a.displayName)?c("div",{className:"message-block message-block-owner",children:[c("div",{className:"message-data-box",children:[e("span",{className:"message-author",children:"You"}),e("p",{className:"message-content",children:s}),e("span",{className:"message-date",children:d})]}),e("div",{className:"message-image-box",children:e(f,{sx:{width:58,height:58},src:t})})]}):c("div",{className:"message-block",children:[e("div",{className:"message-image-box",children:e(f,{sx:{width:58,height:58},src:t})}),c("div",{className:"message-data-box",children:[e("span",{className:"message-author",children:n}),e("p",{className:"message-content",children:s}),e("span",{className:"message-date",children:d})]})]})})}function ae({}){const[s,n,i]=N.monitor();return m.exports.useEffect(()=>{if(s==null||s.docs.forEach(t=>{}),s){const t=document.querySelector("#chatmessages-list");t==null||t.scroll({behavior:"smooth",top:t.offsetHeight*10})}},[s]),c("div",{className:"chatmessages-block",children:[!s&&e(R,{className:"chatmessages-loading-icon"}),s&&e("ul",{id:"chatmessages-list",className:"chatmessages-list",children:s==null?void 0:s.docs.splice(-25).map((t,a)=>{const{content:r,date:l,author:h}=t.data(),d=JSON.parse(h).displayName,p=JSON.parse(h).photoURL;return e(se,{content:r,date:l,author:d,photoURL:p},a)})})]})}function te({}){const s=()=>{u.signOut()};return c("div",{className:"header-block glass",children:[e("div",{className:"header-picture-box",children:e(f,{sx:{width:58,height:58},src:"/assets/img/profile_img.jpeg"})}),c("div",{className:"header-data-box",children:[e("h3",{className:"header-title",children:"Firebase Chat \u2764\uFE0F\u{1F525}"}),e("span",{className:"header-subtitle",children:"Super Dev Team"})]}),e(v,{onClick:()=>s(),children:e(_,{})})]})}function ne({}){u.getAuthState();const s=async()=>{await u.authNewUser()};return c("div",{className:"loginform-block",children:[e("h1",{className:"loginform-title",children:"Sign in"}),e(H,{className:"loginform-loginbutton glass glass-shadows",onClick:()=>s(),startIcon:e(G,{}),children:"Sign in with Google"})]})}function oe({}){const[s,n]=m.exports.useState(""),[i,t]=m.exports.useState(!1),[a,r,l]=u.getAuthState(),h=o=>{n(o.target.value)},d=()=>{if(s!=""){const o=new Date().getTime(),C=~~(o/1e3);N.sendMessage(o.toString(),s,C,a),n("")}},p=o=>{o.key=="Enter"&&(o.preventDefault(),d())},S=o=>{n(s+o.native)},x=()=>{t(!i)},y=()=>{t(!i)};return e("div",{className:"messageinput-block",children:c(q,{className:"messageinput-box glass",sx:{p:"2px 4px",display:"flex",alignItems:"center"},children:[e(v,{className:"messageinput-emoji-picker-iconbutton",sx:{p:"10px"},"aria-label":"emoticons",onClick:o=>x(),children:e(T,{})}),e(U,{className:"messageinput-emoji-picker",in:i,onMouseLeave:()=>y(),children:e(V,{set:"twitter",onSelect:o=>S(o)})}),e(J,{sx:{ml:1,flex:1},placeholder:"Aa",className:"messageinput-input",inputProps:{"aria-label":"New Message"},value:s,onKeyDown:o=>p(o),onChange:o=>h(o),autoFocus:!0}),e(v,{className:"messageinput-send-iconbutton",color:"primary",sx:{p:"10px"},"aria-label":"directions",onClick:()=>d(),children:e(K,{})})]})})}function re({}){return e("div",{className:"view home-view",children:e(ee,{})})}function ie({}){return e("div",{className:"view login-view",children:e(ne,{})})}const ce=s=>[{path:"/",children:[{path:"/",element:s()?e(re,{}):e(g,{to:"/login"})},{path:"/login",element:s()?e(g,{to:"/"}):e(ie,{})},{path:"/logout",element:s()?e("p",{children:"Logging out"}):e(g,{to:"/"})},{path:"*",element:e(g,{to:"/"})}]}];function le(){const[s,n,i]=u.getAuthState();return s}function de({}){let s=W(ce(le));return e(b,{children:s})}function ue(){return e(z,{children:e(de,{})})}Q.render(e(Y.StrictMode,{children:e(ue,{})}),document.getElementById("root"));
